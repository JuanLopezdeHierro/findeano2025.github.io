<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiesta de Fin de AÃ±o 2024</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Iconos SVG
        const Sparkles = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" />
                <path d="M5 3v4" />
                <path d="M19 17v4" />
                <path d="M3 5h4" />
                <path d="M17 19h4" />
            </svg>
        );

        const Wine = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M8 22h8" />
                <path d="M12 11v11" />
                <path d="m19 3-7 8-7-8Z" />
            </svg>
        );

        const Music = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M9 18V5l12-2v13" />
                <circle cx="6" cy="18" r="3" />
                <circle cx="18" cy="16" r="3" />
            </svg>
        );

        const Truck = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2" />
                <path d="M15 18H9" />
                <path d="M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14" />
                <circle cx="17" cy="18" r="2" />
                <circle cx="7" cy="18" r="2" />
            </svg>
        );

        const Cookie = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5" />
                <path d="M8.5 8.5v.01" />
                <path d="M16 15.5v.01" />
                <path d="M12 12v.01" />
                <path d="M11 17v.01" />
                <path d="M7 14v.01" />
            </svg>
        );

        const Utensils = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2" />
                <path d="M7 2v20" />
                <path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7" />
            </svg>
        );

        const PartyOrganizer = () => {
            const [selectedUser, setSelectedUser] = useState('');
            const [tasks, setTasks] = useState({});
            const [loading, setLoading] = useState(true);
            const [saving, setSaving] = useState(false);

            const SHEET_URL = 'https://script.google.com/macros/s/AKfycbxn5Yk7puVurgFr8KIC5jW_x3cmAUyQYZgD-RbkM_6MbIEWlfAva2JdE2a6M7Btk0vZIw/exec';

            const guests = ['Juan', 'Quintana', 'GermÃ¡n', 'Jose', 'Cantero', 'Alejandro', 'David', 'Jorge', 'Arbelo'];

            const taskCategories = [
                { id: 'alcohol', name: 'Alcohol', icon: Wine, description: 'Cantidad de alcohol y refrescos para mezclas y cÃ³cteles' },
                { id: 'musica', name: 'MÃºsica', icon: Music, description: 'Playlist y equipo de sonido apropiado' },
                { id: 'logistica', name: 'LogÃ­stica', icon: Truck, description: 'Mover material y personas a la fiesta' },
                { id: 'snacks', name: 'Snacks', icon: Cookie, description: 'Comprar snacks para acompaÃ±ar las bebidas' },
                { id: 'menaje', name: 'Menaje', icon: Utensils, description: 'Platos, cubiertos, vasos, etc.' }
            ];

            useEffect(() => {
                loadData();
            }, []);

            const loadData = async () => {
                try {
                    const response = await fetch(SHEET_URL);
                    const data = await response.json();
                    setTasks(data);
                } catch (error) {
                    console.error('Error al cargar datos:', error);
                    const initialTasks = {};
                    taskCategories.forEach(cat => {
                        initialTasks[cat.id] = { assignedTo: [], details: '' };
                    });
                    setTasks(initialTasks);
                }
                setLoading(false);
            };

            const saveData = async (newTasks) => {
                setSaving(true);
                try {
                    await fetch(SHEET_URL, {
                        method: 'POST',
                        body: JSON.stringify(newTasks),
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });
                } catch (error) {
                    console.error('Error al guardar:', error);
                    alert('Error al guardar los datos. Por favor, intenta de nuevo.');
                }
                setSaving(false);
            };

            const toggleAssignment = (taskId) => {
                if (!selectedUser) {
                    alert('Por favor, selecciona tu nombre primero');
                    return;
                }

                const newTasks = { ...tasks };
                const assignedTo = newTasks[taskId].assignedTo || [];

                if (assignedTo.includes(selectedUser)) {
                    newTasks[taskId].assignedTo = assignedTo.filter(name => name !== selectedUser);
                } else {
                    newTasks[taskId].assignedTo = [...assignedTo, selectedUser];
                }

                setTasks(newTasks);
                saveData(newTasks);
            };

            const updateDetails = (taskId, details) => {
                const newTasks = { ...tasks };
                newTasks[taskId].details = details;
                setTasks(newTasks);
                saveData(newTasks);
            };

            if (loading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-amber-900 flex items-center justify-center">
                        <div className="text-amber-300 text-xl">Cargando datos de Google Sheets...</div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-amber-900 p-4 md:p-8">
                    {saving && (
                        <div className="fixed top-4 right-4 bg-amber-500 text-slate-900 px-4 py-2 rounded-lg shadow-lg z-50">
                            Guardando...
                        </div>
                    )}

                    <div className="max-w-6xl mx-auto mb-8 text-center">
                        <div className="flex items-center justify-center gap-3 mb-4">
                            <Sparkles size={32} className="text-amber-400" />
                            <h1 className="text-4xl md:text-5xl font-serif text-amber-100">
                                Fiesta de Fin de AÃ±o 2024
                            </h1>
                            <Sparkles size={32} className="text-amber-400" />
                        </div>
                        <div className="h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent mb-6"></div>

                        {!selectedUser ? (
                            <div className="bg-slate-800/50 backdrop-blur border border-amber-500/30 rounded-lg p-6 max-w-md mx-auto">
                                <p className="text-amber-200 mb-4 text-lg">Selecciona tu nombre para comenzar</p>
                                <select
                                    className="w-full bg-slate-900 text-amber-100 border border-amber-500/50 rounded-lg px-4 py-3 text-lg focus:outline-none focus:border-amber-400"
                                    value={selectedUser}
                                    onChange={(e) => setSelectedUser(e.target.value)}
                                >
                                    <option value="">-- Seleccionar --</option>
                                    {guests.map(guest => (
                                        <option key={guest} value={guest}>{guest}</option>
                                    ))}
                                </select>
                            </div>
                        ) : (
                            <div className="bg-slate-800/50 backdrop-blur border border-amber-500/30 rounded-lg p-4 max-w-md mx-auto">
                                <p className="text-amber-200">
                                    Bienvenido, <span className="text-amber-400 font-semibold">{selectedUser}</span>
                                    <button
                                        onClick={() => setSelectedUser('')}
                                        className="ml-4 text-amber-500 hover:text-amber-400 underline text-sm"
                                    >
                                        Cambiar
                                    </button>
                                </p>
                            </div>
                        )}
                    </div>

                    <div className="max-w-6xl mx-auto mb-4 text-center">
                        <button
                            onClick={loadData}
                            className="bg-slate-700 text-amber-300 px-4 py-2 rounded-lg hover:bg-slate-600 transition-all border border-amber-500/30"
                        >
                            ðŸ”„ Actualizar datos
                        </button>
                    </div>

                    <div className="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-6">
                        {taskCategories.map(category => {
                            const Icon = category.icon;
                            const taskData = tasks[category.id] || { assignedTo: [], details: '' };
                            const isAssigned = taskData.assignedTo.includes(selectedUser);

                            return (
                                <div
                                    key={category.id}
                                    className="bg-slate-800/70 backdrop-blur border border-amber-500/30 rounded-lg p-6 hover:border-amber-400/50 transition-all"
                                >
                                    <div className="flex items-start gap-4 mb-4">
                                        <div className="bg-amber-500/20 p-3 rounded-lg">
                                            <Icon size={28} className="text-amber-400" />
                                        </div>
                                        <div className="flex-1">
                                            <h3 className="text-xl font-semibold text-amber-100 mb-1">{category.name}</h3>
                                            <p className="text-amber-200/70 text-sm">{category.description}</p>
                                        </div>
                                    </div>

                                    <div className="mb-4">
                                        <p className="text-amber-300/80 text-sm mb-2">Responsables:</p>
                                        <div className="flex flex-wrap gap-2">
                                            {taskData.assignedTo.length > 0 ? (
                                                taskData.assignedTo.map(person => (
                                                    <span
                                                        key={person}
                                                        className="bg-amber-500/20 text-amber-300 px-3 py-1 rounded-full text-sm border border-amber-500/30"
                                                    >
                                                        {person}
                                                    </span>
                                                ))
                                            ) : (
                                                <span className="text-amber-200/50 text-sm italic">Sin asignar</span>
                                            )}
                                        </div>
                                    </div>

                                    <button
                                        onClick={() => toggleAssignment(category.id)}
                                        disabled={!selectedUser || saving}
                                        className={`w-full py-2 rounded-lg font-medium transition-all mb-4 ${isAssigned
                                                ? 'bg-amber-500 text-slate-900 hover:bg-amber-400'
                                                : 'bg-slate-700 text-amber-200 hover:bg-slate-600 border border-amber-500/30'
                                            } disabled:opacity-50 disabled:cursor-not-allowed`}
                                    >
                                        {isAssigned ? 'âœ“ Apuntado' : 'Apuntarme'}
                                    </button>

                                    {taskData.assignedTo.length > 0 && (
                                        <div>
                                            <label className="text-amber-300/80 text-sm mb-2 block">
                                                Detalles y cantidades:
                                            </label>
                                            <textarea
                                                value={taskData.details}
                                                onChange={(e) => updateDetails(category.id, e.target.value)}
                                                placeholder="Ej: 2 botellas de vodka, 3L de jugo de naranja..."
                                                className="w-full bg-slate-900/70 text-amber-100 border border-amber-500/30 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-amber-400 resize-none"
                                                rows="3"
                                                disabled={saving}
                                            />
                                        </div>
                                    )}
                                </div>
                            );
                        })}
                    </div>

                    <div className="max-w-6xl mx-auto mt-8 text-center">
                        <div className="h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent mb-4"></div>
                        <p className="text-amber-300/60 text-sm mb-2">
                            Â¡Feliz AÃ±o Nuevo 2025! ðŸ¥‚
                        </p>
                        <p className="text-amber-300/40 text-xs">
                            Conectado a Google Sheets
                        </p>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<PartyOrganizer />, document.getElementById('root'));
    </script>
</body>

</html>